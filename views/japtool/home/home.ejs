<script type="text/javascript">
    /*window.onload = function () {
     $(".bookMaterIdClass").each(function () {
     var bookId = $(this).val();
     var startDate = $("#startDate" + bookId).val();
     var finishDate = $("#finishDate" + bookId).val();
     var learningId = $("#learningId" + bookId).val();
     var data = {
     bookId: bookId,
     startDate: startDate,
     finishDate: finishDate,
     learningId: learningId
     };
     $.ajax({
     method: "GET",
     url: "/japtool/Learning/getMissLesson",
     data: data
     }).done(function (data) {
     console.log(data);
     data.forEach(function (item) {
     $("#" + bookId).append(
     '<div class="col-sm-3">' +
     '<div class="info-lesson label-warning"><a>' + item.lesson + ' </a></div>' +
     '</div>'
     );
     });

     });

     });

     };*/
</script>
<div class="vocabulary content clearfix">
    <div class="container">

        <% if(selfLearnings != undefined && selfLearnings.length > 0){ %>
        <% selfLearnings.forEach(function(selfLearning, index){ %>
        <div class="row">
            <h2 class="text-left clearfix"><%= selfLearning.bookMaster.name %></h2>
            <% for(var j = 0;j < b[index].length;j++){ %>
            <% var a = false; %>
            <% var d; %>
            <% for(var i = 0;i < selfLearning.userLearnHistories.length;i++){ %>
            <% if(b[index][j] == selfLearning.userLearnHistories[i].lesson){ %>
            <% a = true; %>
            <% if(selfLearning.userLearnHistories[i].status){ %>
            <% if(selfLearning.userLearnHistories[i].status == 'passed'){ %>
            <% d = 1; %>
            <% }else if(selfLearning.userLearnHistories[i].status == 'false'){ %>
            <% d = 2; %>
            <% } %>
            <% } %>
            <% } %>
            <% } %>
            <div class="row">

                <% if(a == true){ %>
                <% if(d == 1){ %>
                <h6 style="color: #008800">
                    <%= b[index][j] %></h6>
                <% }else if(d == 2){ %>
                <h6 style="color: #880000">
                    <%= b[index][j] %></h6>
                <% }else{ %>
                <h6 style="color: #ffff00">
                    <%= b[index][j] %></h6>
                <% } %>

                <% }else{ %>
                <h6>
                    <%= b[index][j] %></h6>
                <% } %>
            </div>

            <% } %>

            <p class="text-center desc-home"><%= __("Display japanese learning group of your friend , let's join now") %></p>

            <p class="text-center desc-home"><i><a><%= __("view all") %></a></i></p>
            <!--Show bool user History-->
            <div class="col-sm-6">
                <div class="vocabulary-item">
                    <div class="info">
                        <% if(selfLearning.bookMaster != null && selfLearning.bookMaster != undefined){ %>
                        <% var bookMasterId = selfLearning.bookMaster.id %>
                        <input type="hidden" value="<%= bookMasterId %>" class="bookMaterIdClass"/>
                        <input type="hidden" value="<%= selfLearning.startDate %>"
                               id="startDate<%= bookMasterId %>"/>
                        <input type="hidden" value="<%= selfLearning.finishDate %>"
                               id="finishDate<%= bookMasterId %>"/>
                        <input type="hidden" value="<%= selfLearning.id %>" id="learningId<%= bookMasterId %>"/>

                        <% } %>
                        <p>Till now you have miss x lesson! That maybe: </p>


                        <div id="<%= bookMasterId %>"></div>
                        <!--Ended Show miss following lesson-->

                        <!--Show learn history-->
                        <% var showNumber = 0; %>
                        <div class="row info-learning">
                            <% if(selfLearning.userLearnHistories != undefined && selfLearning.userLearnHistories.length > 0){ %>
                            <% selfLearning.userLearnHistories.forEach(function(userLearn){ %>
                            <% if(showNumber >= 4){ %>
                            <div class="col-sm-9" style="display: none">
                                <!--<span class="label label-primary"><%= userLearn.lesson %></span>-->
                                <p>
                                    <span class="glyphicon glyphicon-thumbs-up"></span> <%= __("You have done ") %><%= userLearn.subLesson %> <%= __("on") %> <%= userLearn.lesson %>
                                </p>
                            </div>
                            <div class="col-sm-3" style="display: none">
                                <a class="join-learn btn label-danger"
                                   href="/japtool/Learning/practice/?id=<%= bookMasterId %>&learnID=<%= selfLearning.id %>"><%= __("Continue") %></a>
                            </div>
                            <% }else{ showNumber++; %>
                            <div class="col-sm-9" style="display: block">
                                <!--<span class="label label-primary"><%= userLearn.lesson %></span>-->
                                <p>
                                    <span class="glyphicon glyphicon-thumbs-up"></span><%= __("You have done ") %> <%= userLearn.subLesson %> <%= __("on") %> <%= userLearn.lesson %>
                                </p>
                            </div>
                            <div class="col-sm-3" style="display: block">
                                <a class="join-learn btn label-danger"
                                   href="/japtool/Learning/practice/?id=<%= bookMasterId %>&learnID=<%= selfLearning.id %>"><%= __("Continue") %></a>
                            </div>
                            <% } %>
                            <% }); %>
                            <!--End for-->
                            <% } else { %>
                            <h5>No learn history</h5>
                            <% } %>
                            <!--End if-->
                        </div>
                        <!--Ended Show learn history-->
                        <p class="text-center desc-home"><i><a><%= __("view all") %></a></i></p>
                    </div>
                </div>
            </div>

        </div>
        <% }); %>
        <% } else { %>
        <div><h1><%= __("No Content") %></h1></div>
        <% } %>
    </div>
</div>
