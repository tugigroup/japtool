<script>

    $('.slider-for').slick({
        slidesToShow: 1,
        slidesToScroll: 1,
//  arrows: true,
        fade: false,
        asNavFor: '.slider-nav',
        draggable: true,
        prevArrow: '<button type="button" data-role="none" class="btn btn-show-list btn-arrow-left" aria-label="Previous" tabindex="0" role="button"><i class="fa fa-chevron-left"></i></button>',
        nextArrow: '<button type="button" data-role="none" class="btn btn-show-list btn-arrow-right" aria-label="Next" tabindex="0" role="button"><i class="fa fa-chevron-right"></i></button>'
    });
    $('.slider-nav').slick({
        slidesToShow: 3,
        slidesToScroll: 3,
        asNavFor: '.slider-for',
        dots: false,
        centerMode: false,
        focusOnSelect: true
    });
    var audioconfig = true;
    var infoconfig = true;
    $(document).ready(function () {
        $('.info-off').hide();
        $('.info-on').on('click', function () {
            $('.info-off').show();
            $('.info-on').hide();
            infoconfig = false;
        });
        $('.info-off').on('click', function () {
            $('.info-on').show();
            $('.info-off').hide();
            infoconfig = true;
        });
        $('.mic-off').hide();
        $('.mic-on').on('click', function () {
            $('.mic-off').show();
            $('.mic-on').hide();
            audioconfig = false;
        });
        $('.mic-off').on('click', function () {
            $('.mic-on').show();
            $('.mic-off').hide();
            audioconfig = true;
        });
        $('[data-toggle="tooltip"]').tooltip();


        // count page
        var $status = $('.pagingCnt');
        var $slickElement = $('.slider-for');
        $slickElement.on('init reInit afterChange', function (event, slick, currentSlide, nextSlide) {
            //currentSlide is undefined on init -- set it to 0 in this case (currentSlide is 0 based)
            var i = (currentSlide ? currentSlide : 0) + 1;
            $status.text(i + '/' + slick.slideCount);
        });

    });
    // Google TEXT TO SPEECH
    function text2speech(w, tl, id) {
        var speech = 'select * from data.uri where url="http://translate.google.com/translate_tts?ie=utf-8&tl=' + encodeURIComponent(tl) + "&q=" + encodeURIComponent(w) + '"';
        $.getJSON('https://query.yahooapis.com/v1/public/yql?q=' + encodeURIComponent(speech) + '&format=json&diagnostics=true', function (data) {
            var audioSrc = data.query.results.url;
            if (data && audioSrc !== undefined) {
                $('#' + id)[0].src = audioSrc;
            }
        });
    }
    function playAudio(id) {
        if (audioconfig) {
            $('#' + id)[0].play();
        }
    }
    //END TEXT2SPEECH
    function show(index) {
        var exam = '[custom = display-delay-' + index + ']';
        $(exam).delay(2000).slideDown();
    }
    $('.slider-for').on('init reInit afterChange', function (event, slick, currentSlide) {
        var i = (currentSlide ? currentSlide : 0) + 1;
        show(i);
    });
    function showDetails(item) {
        if (infoconfig) {
            $('.' + item).slideDown();
        }
    }
    $('span').tooltip();

</script>

<div id="vocabularyList" class="voca-list-sum">
    <%
    var sumPage=vocabularies.length;
    if(vocabularies == null || vocabularies.length == 0){
    %>
    <h5 class="text-center text-danger">Không tìm thấy dữ liệu</h5>
    <% }else{ %>
    <div class="slider slider-for">
        <%
            vocabularies.forEach( function(vocabulary, index){
        %>

        <div class="learn-kanji">
            <div class="col-sm-offset-3 col-sm-6">
                <i class="fa fa-check-circle-o info-on" title="off informations"></i>
                <i class="fa fa-minus-circle info-off" title="on informations"></i>
                &nbsp;
                <i class="fa fa-volume-up mic-on" data-toggle="tooltip" data-placement="top" title="off audio"></i>
                <i class="fa fa-volume-off mic-off" data-toggle="tooltip" data-placement="top" title="on audio"></i>
            </div>
            <div class="col-sm-offset-3 col-sm-6">
                <div class="panel panel-default panel-paper-slide">
                    <div class="panel-body">
                        <div class="vocabulary text-center">
                            <div class="card">
                                <!--1-->
                                <p class="not-display <%= index %>">
                                    <span class="text-success">Reading
                                      <i class="fa fa-microphone text-danger"
                                         onclick="playAudio('vocabulary-audio-<%= index %>');"></i> :
                                    </span>
                                    <%= vocabulary.reading %>
                                    <audio id="vocabulary-audio-<%= index %>"></audio>
                                </p>
                                <!--end 1-->
                                <div class="front">
                                    <h3 class="text-center text-danger text-center-list-voca"
                                        onclick="showDetails('<%= index %>'); playAudio('vocabulary-audio-<%= index %>');"><%= vocabulary.item %>
                                    </h3>
                                </div>
                            </div>
                        </div>
                        <div class="details-voca not-display <%= index %>">

                            <% if(vocabulary.description){ %>
                            <p>
                            <span class="lb-mean size-lb"><span
                                        class="glyphicon glyphicon-screenshot"></span> Description: <%= vocabulary.description %></span>
                            </p>
                            <% } %>

                            <!--3-->
                            <% if (typeof vocabulary.examples !== 'undefined' && vocabulary.examples.length > 0) { %>
                            <p custom="display-delay-<%= index + 1 %>">
                                <span class="text-success">Example: </span>
                            </p>
                            <ul custom="display-delay-<%= index + 1 %>" class="vocabulary-item-example">
                                <% vocabulary.examples.forEach( function(item, index){ %>
                                <% if (item.example == 'undefined' || item.example.length == 0){ %>
                                <% }else { %>
                                <li>
                                  <span class="text-danger" data-toggle="tooltip" data-placement="right"
                                        title="<%= item.meaning %>">
                                    <%= index + 1 %>. <%= item.example %>
                                  </span>
                                </li>
                                <% } %>
                                <% }) %>
                            </ul>
                            <% } %>
                            <!--end 3-->
                        </div>
                        <div class="col-sm-offset-10 col-sm-1">
                            <span class="pagingCnt">1/<%=sumPage%></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <% }) %>
    </div>
    <!--scroll bar-->
    <div class="col-sm-offset-3 col-sm-6">
        <div class="slider slider-nav">
            <% vocabularies.forEach( function(vocabulary, index){ %>
            <div><h3><%= vocabulary.item %></h3></div>
            <% }) %>
        </div>
    </div>
    <% } %>
</div>
<script>
    (function () {
        $("[custom = 'display-delay-1']").delay(2000).slideDown();
    })();
</script>
<!--GET AUDIO DATA-->
<% vocabularies.forEach( function(vocabulary, index){ %>
<script>
    text2speech('<%= vocabulary.reading %>', 'ja', 'vocabulary-audio-<%= index %>');
</script>
<% }) %>
<!--END GET AUDIO DATA-->


